apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: supplychainvalidator4ibft
  namespace: supplychain-bes
  annotations:
    flux.weave.works/automated: "false"
spec:
  releaseName: supplychainvalidator4ibft
  chart:
    git: git@github.com:suvajit-sarkar/blockchain-automation-framework.git
    ref: workspace
    path: platforms/hyperledger-besu/charts/node_validator 
  values:
    replicaCount: 1

    healthcheck:
      readinessthreshold: 100
      readinesscheckinterval: 5

    staticnodes:
      - "enode://3960206d99feed4a4323850a578871ba2e78613e9e6e059add38445c98365fb5c9de886d7558acf4ed262e7fc494cf4300a89af6211f4b2ff09b34cde1be4fd7@validator1.bes.demo.aws.blockchaincloudpoc.com:15010"
      
      - "enode://496d22167ca277d7bd984a81044dad775b5d6e2bffd251a02edc377477f7f2a4270fe5bb4a8e6131a0666e9a65b7b76af32af78ed8fbc5d0bd6ef0c551349ab0@validator2.bes.demo.aws.blockchaincloudpoc.com:15012"
      
      - "enode://d02d84bd8b3450b3be6c9076bdec72af08ad7fade011b90c59d25995e2198273ba0c0c7d2423237c904ec613f7f62689df46061e54f31fb1b6d6c9a36692a820@validator3.bes.demo.aws.blockchaincloudpoc.com:15014"
      
      - "enode://576aee57b7a130b8f9ccacb888b2badb8c2e372ca7eb20e9dc33485ee3c37d7a76c672d6d0282495ab391c4e7b12c159b8cfd47c86bac439f9a2e55534a825bf@validator4.bes.demo.aws.blockchaincloudpoc.com:15016"
      
      - "enode://9f3666984a9528efca6e658e7cc525f28d2619ed2e98bbb91fe2f731354cef5639cbf9ea3a761ee54da18c39a02c5277c061e300be692a8d30300235eeebbe58@carrier.bes.demo.aws.blockchaincloudpoc.com:15018"
      
      - "enode://35673227961c3c811ebc95180cdafd764ee96db0b8b2c0c8875597dd78141ef8a6f5e7e2b7adc30ebf0749b503086c6ff9dacf1922f0501f1aa0f8f0ec132b25@manufacturer.bes.demo.aws.blockchaincloudpoc.com:15020"
      

    metadata:
      namespace: supplychain-bes
      labels:

    ambassador:
      external_url_suffix: bes.demo.aws.blockchaincloudpoc.com

    liveliness_check:
      enabled: false
 
    proxy:
      provider: ambassador
      external_url: supplychain.bes.demo.aws.blockchaincloudpoc.com
      p2p: 15016
      rpc: 15017

    images:
      node: hyperledger/besu:21.10.6
      alpineutils: hyperledgerlabs/alpine-utils:1.0

    node:
      name: validator4
      tls: True
      consensus: ibft
      mountPath: /opt/besu/data
      servicetype: ClusterIP
      imagePullSecret: regcred
      ports:
        p2p: 30303
        rpc: 8545
        ws: 8546

    storage:
      storageclassname: awsstorageclass
      storagesize: 1Gi

    vault:
      address: http://vault.internal.demo.aws.blockchaincloudpoc.com:9001
      secretprefix: secretsv2/data/supplychain-bes/crypto/validator4
      serviceaccountname: vault-auth
      keyname: data
      tlsdir: tls
      role: vault-role
      authpath: besusupplychain

    genesis: ewogICJjb25maWciOiB7CiAgICAiY2hhaW5JZCI6IDIwMTgsCiAgICAiY29uc3RhbnRpbm9wbGVmaXhibG9jayI6IDAsCiAgICAiY29udHJhY3RTaXplTGltaXQiOiAyMTQ3NDgzNjQ3LAogICAgImliZnQyIjogewogICAgICAiYmxvY2twZXJpb2RzZWNvbmRzIjogMiwKICAgICAgImVwb2NobGVuZ3RoIjogMzAwMDAsCiAgICAgICJyZXF1ZXN0dGltZW91dHNlY29uZHMiOiAxMAogICAgfQogIH0sCiAgIm5vbmNlIjogIjB4MCIsCiAgInRpbWVzdGFtcCI6ICIweDU4ZWU0MGJhIiwKICAiZ2FzTGltaXQiOiAiMHgxZmZmZmZmZmZmZmZmZiIsCiAgImRpZmZpY3VsdHkiOiAiMHgxIiwKICAiZXh0cmFEYXRhIjogIjB4Zjg3ZWEwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMGY4NTQ5NDA2ZGY5YTdiNDE0N2RiMGUwNmU1OTYxMWUzMDlhMmMzMmI1N2E1MjA5NDUyODQ2N2I3N2RlZmE5YjM1NzdhMmJmMzVhYzk0YTNkMjg5ZTVmMjY5NDRjMTU2MGYxMmMwZjA1NmY1ZDI2YTI3NzE1NTY1YzMyYjQ4MzhmZmY5NDFlYTg0N2E4YmZmOTEwMmIwOGJiODlhMTVhMDg3NzdiM2VmZGVmMjM4MDg0MDAwMDAwMDBjMCIKfQ==
